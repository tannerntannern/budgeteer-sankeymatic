parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"1cQ8":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){"use strict";function n(t){return t.replace(/→/g,"&#8594;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\n/g,"<br />")}function o(t,e){return","!==e.thousands?t.replace(/,/g,"!").replace(/\./g,e.decimal).replace(/!/g,e.thousands):t}function r(t,e,n,r,a,i){var l=o(d3.format(",."+e+"f")(t),n);return r+(i?l:l.replace(/(\.\d*?)0+$/,"$1").replace(/\.$/,""))+a}function a(t){var e="";return Array.prototype.slice.call(document.getElementsByName(t)).forEach(function(t){t.checked&&(e=t.value)}),e}function i(t,e){return e?"background-color: transparent; background-image: url(../img/transparent_bg.png); background-repeat: repeat;":"background-color: "+t+";"}function l(t,e,n,o){document.getElementById("chart").innerHTML='<svg id="sankey_svg" height="'+e+'" width="'+t+'" xmlns="http://www.w3.org/2000/svg" version="1.1" style="'+i(n,o)+'"></svg>'}function s(){var t,e=document.getElementById("sankey_svg"),n=(new XMLSerializer).serializeToString(e),o=document.getElementById("png_preview"),r=document.getElementById("download_png_link"),i=document.getElementById("chart"),l=document.getElementById("img_tag_hint"),s=a("scale_x")||1,u=Number(i.style.width.replace(/px/,"")),c=Number(i.style.height.replace(/px/,"")),d=u*s,g=c*s,f=o.getContext("2d"),m=e.style.backgroundColor||"";o.width=d,o.height=g,canvg(o,n,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,scaleWidth:d,scaleHeight:g}),f.globalCompositeOperation="destination-over",f.fillStyle=m,f.fillRect(0,0,d,g),t=o.toDataURL("image/png"),r.setAttribute("href",t),r.setAttribute("target","_blank"),r.innerHTML="Export "+d+" x "+g+" PNG",r.setAttribute("download","sankeymatic_"+d+"x"+g+".png"),l.innerHTML="<code>&lt;img width=&quot;<strong>"+u+"</strong>&quot; height=&quot;<strong>"+c+"</strong>&quot; ... /&gt;</code>"}function u(){var t=document.getElementById("svg_for_export"),e=document.getElementById("sankey_svg"),o=document.getElementById("chart").innerHTML.replace(/ style="[^"]+"/,"").replace(/><g/,"><title>Your Diagram Title</title>\x3c!-- Generated with SankeyMATIC on "+new Date+'--\x3e<g><rect width="100%" height="100%" fill="'+e.style.backgroundColor+'"></rect><g').replace(/<\/svg>/,"</g></svg>");t.innerHTML=n(o)}t.toggle_panel=function(t){var e=document.getElementById(t),n=document.getElementById(t+"_indicator"),o=document.getElementById(t+"_hint"),r="none"!==e.style.display;return e.style.display=r?"none":"",o.innerHTML=r?"...":":",n.innerHTML=r?"&dArr;":"&uArr;",null},t.render_updated_outputs=function(){var t=document.getElementById("download_png_link"),e=document.getElementById("svg_for_export");return t.innerHTML="...creating downloadable graphic...",t.setAttribute("href","#"),e.innerHTML="(generating SVG code...)",setTimeout(s,0),setTimeout(u,0),null},t.process_sankey=function(){var s,u,c,d,g=[],f=[],m=[],_=[],h=[],p=0,y="",v={},b=[],w=0,x=0,k=[],E=[],I={},B=0,T=0,M=0,A=0,F="",N=0,L=0,H="",S="",$="",C=document.getElementById("chart"),q=document.getElementById("messages_area"),D=document.getElementById("background_color"),O=document.getElementById("flows_in").value;function z(t,e,n){var o='<p class="'+t+'">'+e+"</p>";q.innerHTML=n?o+q.innerHTML:q.innerHTML+o}function U(t,e){return r(t,e||M,I.seps,I.unit_prefix,I.unit_suffix,I.display_full_precision)}function X(t){var e=Math.abs(t)>11*A;return"&Delta; = "+(e?"<strong>":"")+(t>=0?"+":"-")+U(Math.abs(t))+(e?"</strong>":"")}function j(t,e){return'(<dfn title="'+e.join(" + ")+'">'+U(t)+"</dfn>)"}for(q.innerHTML="",document.getElementById("background_transparent").checked?D.setAttribute("disabled","disabled"):D.removeAttribute("disabled"),g=O.split("\n"),p=0;p<g.length;p+=1)(y=g[p].trim()).match(/^'/)||(null===(b=y.match(/^:(.+)\ #([0-9A-F]{0,6})?(\.\d{1,4})?\s*(>>|<<)*\s*(>>|<<)*$/i))?null!==(b=y.match(/^(.+)\[([\d\.\s\+\-]+)\](.+)$/))?(w=b[2].replace(/\s/g,""),(d=w)-parseFloat(d)>=0?w<=0?_.push({value:y,message:"Amounts must be greater than 0."}):(f.push({source:b[1].trim(),target:b[3].trim(),amount:w}),M=Math.max(M,(w.split(/\./)[1]||"").length)):_.push({value:y,message:"The Amount is not a valid decimal number."})):""!==y&&_.push({value:y,message:"The line is not in the format: Source [Amount] Target"}):m.push({name:b[1].trim(),color:b[2],opacity:b[3],inherit1:b[4],inherit2:b[5]}));function G(t,n){v.hasOwnProperty(t)||(v[t]={from_sum:0,to_sum:0,from_list:[],to_list:[],index:h.length},h.push(t)),"object"===e(n)&&Object.keys(n).forEach(function(e){null!==n[e]&&""!==n[e]&&(v[t][e]=n[e])})}function P(t){document.getElementById(t).value=I[t]}if(A=Math.pow(10,-M-1),_.forEach(function(t){z("errormessage","&quot;<b>"+n(t.value)+"</b>&quot;: "+t.message,!1)}),I={unit_prefix:"",unit_suffix:"",number_format:",.",seps:{thousands:",",decimal:"."},max_places:M,display_full_precision:1,include_values_in_node_labels:0,show_labels:1,canvas_width:600,canvas_height:600,font_size:13,font_weight:400,top_margin:12,right_margin:12,bottom_margin:12,left_margin:12,default_flow_opacity:.4,default_node_opacity:.9,node_width:10,node_padding:18,node_border:0,reverse_graph:0,curvature:.5,default_flow_inherit:"target",default_flow_color:"#666666",background_color:"#FFFFFF",background_transparent:0,font_color:"#000000",default_node_color:"#006699",default_node_colorset:"C",font_face:"sans-serif"},m.forEach(function(t){t.color&&t.color.match(/[0-9A-F]{3,6}/i)&&(t.color="#"+t.color),G(t.name,t)}),c=document.getElementById("reverse_graph").checked,f.forEach(function(t){var e,n,o="",r="",a="",i="",l={};null!==(b=t.target.match(/^(.+)\s+(#\S+)$/))&&(n=b[1],e=b[2],null!==(b=e.match(/^#([0-9A-F]{3,6})?(\.\d{1,4})?$/i))&&(t.target=n,b[1]&&(o="#"+b[1]),b[2]&&(a=b[2],i=(Number(a)+1)/2))),G(t.source),G(t.target),l={source:v[t.source].index,target:v[t.target].index,value:t.amount,color:o,opacity:a,opacity_on_hover:i},c&&(r=l.source,l.source=l.target,l.target=r),E.push(l),v[t.source].from_sum+=Number(t.amount),v[t.source].from_list.push(t.amount),v[t.target].to_sum+=Number(t.amount),v[t.target].to_list.push(t.amount)}),h.forEach(function(t){var e,n,o,r,a=v[t];n="<<"===a.inherit1||"<<"===a.inherit2?1:0,o=">>"===a.inherit1||">>"===a.inherit2?1:0,e={name:t,index:a.index,color:a.color,opacity:a.opacity,inherit_right:c?n:o,inherit_left:c?o:n},(r=Math.max(a.from_sum,a.to_sum))>L&&(N=a.index,L=r),k.push(e)}),["canvas_width","canvas_height","font_size","top_margin","right_margin","bottom_margin","left_margin","font_weight","node_padding","node_width","node_border"].forEach(function(t){var e=document.getElementById(t).value;e.length<10&&e.match(/^\d+$/)?I[t]=Number(e):P(t)}),["default_flow_color","background_color","font_color","default_node_color"].forEach(function(t){!function(t){var e=document.getElementById(t),n=e.value;n.match(/^#(?:[a-f0-9]{3}|[a-f0-9]{6})$/i)?I[t]=n:n.match(/^(?:[a-f0-9]{3}|[a-f0-9]{6})$/i)?(n="#"+n,I[t]=n,e.value=n):P(t)}(t)}),C.style.height=I.canvas_height+"px",C.style.width=I.canvas_width+"px",0===f.length)return z("okmessage",'Enter a list of Flows (one per line). See the <a href="/manual/" target="_blank">Manual</a> for more help.',!1),l(I.canvas_width,I.canvas_height,I.background_color,I.background_transparent),t.render_updated_outputs(),null;["unit_prefix","unit_suffix"].forEach(function(t){var e=document.getElementById(t).value;e.length<=10?I[t]=e:P(t)}),["number_format"].forEach(function(t){var e={thousands:",",decimal:"."},n=document.getElementById(t).value;2===n.length&&/^[,.\ X][,.]$/.exec(n)?(e.thousands=/^[,.\ X]/.exec(n)[0],"X"===e.thousands&&(e.thousands=""),e.decimal=/^.([,.])/.exec(n)[1]):P(t),I.seps=e}),(H=a("default_flow_inherit")).match(/^(?:source|target|none)$/)&&(c&&(H="source"===H?"target":"target"===H?"source":"none"),I.default_flow_inherit=H),(S=a("default_node_colorset")).match(/^(?:[ABC]|none)$/)&&(I.default_node_colorset=S),($=a("font_face")).match(/^(?:serif|sans-serif|monospace)$/)&&(I.font_face=$),["display_full_precision","include_values_in_node_labels","show_labels","background_transparent"].forEach(function(t){I[t]=document.getElementById(t).checked}),["default_node_opacity","default_flow_opacity","curvature"].forEach(function(t){var e=document.getElementById(t).value;e.match(/^\d(?:.\d+)?$/)?I[t]=e:P(t)}),s=document.getElementById("flow_cross_check").checked,h.forEach(function(t){var e=v[t],o=0;e.from_sum>0&&e.to_sum>0?(o=e.to_sum-e.from_sum,s&&Math.abs(o)>=A&&(0===x&&z("cautionmessage","The Flow Cross-Checker found some <strong>Imbalances:</strong>",!1),x+=1,z("cautionmessage","&quot;<b>"+n(t)+"</b>&quot;: Amount IN "+j(e.to_sum,e.to_list)+" &ne; OUT "+j(e.from_sum,e.from_list)+". "+X(o),!1))):(B+=e.from_sum,T+=e.to_sum)}),F="Showing: <strong>"+E.length+" Flows</strong> between <strong>"+k.length+" Nodes</strong>.",u=B-T,Math.abs(u)<A?F+=" Diagram Total IN = Total OUT = <strong>"+U(B)+"</strong>.":s?z("cautionmessage","<strong>Diagram Total IN</strong> ("+U(B)+") &ne; <strong>Total OUT</strong> ("+U(T)+"). "+X(u),!1):F+=" Diagram Total <strong>IN</strong> = <strong>"+U(B)+"</strong>. Total <strong>OUT</strong> = <strong>"+U(T)+"</strong>.",s?0===x&&(F+=" No imbalances found."):F+=' <span class="importanttext">Flow Cross-Check is <strong>OFF</strong>.</span>',z("okmessage",F,!0),function(e,n,o){var a,s,u,c,d,g,f,m,_,h,p=o.node_width,y=o.node_padding,v=o.canvas_width,b=o.canvas_height,w=o.top_margin,x=o.bottom_margin,k=o.left_margin,E=o.right_margin,I=o.curvature,B=o.seps;o.unit_prefix=void 0===o.unit_prefix||null===o.unit_prefix?"":o.unit_prefix,o.unit_suffix=void 0===o.unit_suffix||null===o.unit_suffix?"":o.unit_suffix,B.thousands=void 0===B.thousands||null===B.thousands?",":B.thousands,B.decimal=void 0===B.decimal||null===B.decimal?".":B.decimal,u=o.default_node_colorset,d="A"===u?d3.scale.category20():"B"===u?d3.scale.category20b():d3.scale.category20c(),e.forEach(function(t){if(void 0===t.color||""===t.color)if("none"===u)t.color=o.default_node_color;else{var e=(/^\W*(\w+)/.exec(t.name)||["","not a word"])[1];t.color=d(e)}});var T={nodes:e,links:n};a=v-k-E,s=b-w-x,c=function(t){return r(t,o.max_places,B,o.unit_prefix,o.unit_suffix,o.display_full_precision)},l(v,b,o.background_color,o.background_transparent),g=d3.select("#sankey_svg").attr("width",v).attr("height",b).attr("style",i(o.background_color,o.background_transparent)).append("g").attr("transform","translate("+k+","+w+")"),f=d3.sankey().nodeWidth(p).nodePadding(y).size([a,s]).nodes(T.nodes).links(T.links).curvature(I).layout(50),m=f.link(),_=g.append("g").selectAll(".link").data(T.links).enter().append("path").attr("class","link").attr("d",m).style("fill","none").style("stroke-width",function(t){return Math.max(1,t.dy)}).style("stroke",function(t){return t.color?t.color:t.source.inherit_right?t.source.color:t.target.inherit_left?t.target.color:"source"===o.default_flow_inherit?t.source.color:"target"===o.default_flow_inherit?t.target.color:o.default_flow_color}).style("stroke-opacity",function(t){return t.opacity||o.default_flow_opacity}).on("mouseover",function(t){d3.select(this).style("stroke-opacity",t.opacity_on_hover||(Number(o.default_flow_opacity)+1)/2)}).on("mouseout",function(t){d3.select(this).style("stroke-opacity",t.opacity||o.default_flow_opacity)}).sort(function(t,e){return e.dy-t.dy}),o.show_labels&&_.append("title").text(function(t){return t.source.name+" → "+t.target.name+":\n"+c(t.value)}),(h=g.append("g").selectAll(".node").data(T.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.behavior.drag().origin(function(t){return t}).on("dragstart",function(){this.parentNode.appendChild(this)}).on("drag",function(e){e.x=Math.max(0,Math.min(a-e.dx,d3.event.x)),e.y=Math.max(0,Math.min(s-e.dy,d3.event.y)),d3.select(this).attr("transform","translate("+e.x+","+e.y+")"),f.relayout(),_.attr("d",m),t.render_updated_outputs()}))).append("rect").attr("height",function(t){return t.dy}).attr("width",p).attr("id",function(t){return"r"+t.index}).style("fill",function(t){return t.color}).attr("shape-rendering","crispEdges").style("fill-opacity",function(t){return t.opacity||o.default_node_opacity}).style("stroke-width",o.node_border||0).style("stroke",function(t){return d3.rgb(t.color).darker(2)}).append("title").text(function(t){return o.show_labels?t.name+":\n"+c(t.value):""}),h.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){return o.show_labels?t.name+(o.include_values_in_node_labels?": "+c(t.value):""):""}).style({"stroke-width":"0","font-family":o.font_face,"font-size":o.font_size+"px","font-weight":o.font_weight,fill:o.font_color}).filter(function(t){return t.x+p<a/2}).attr("x",6+p).attr("text-anchor","start")}(k,E,I);var W=parseFloat(document.getElementById("r"+N).getAttributeNS(null,"height")),R=U(L)+" / "+o(d3.format(",.2f")(W),I.seps)+"px = <strong>"+U(L/W,6)+"/px</strong>";return document.getElementById("scale_figures").innerHTML=R,t.render_updated_outputs(),null}}("undefined"===window?t:window);
},{}]},{},["1cQ8"], null)